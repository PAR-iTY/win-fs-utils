<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: isMainESM.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: isMainESM.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// --------------------------------------------------------------------------- //

// for this to work as a module, it can't be done so simply, calling main returns:

// process.argv[1]:  C:\DEV\win-fs-utils\main
// import.meta.url:  file:///C:/DEV/win-fs-utils/isMainESM.js

// this code must use the callers import.meta.url value to work
// could be a Class and instantiated inside main.js?
// or some similar kind of function composition?

// the other way is pass in import.meta from main.js

// --------------------------------------------------------------------------- //

import { fileURLToPath } from 'url';
import { extname } from 'path';

// --------------------------------------------------------------------------- //

/**
 * ES Modules version of require.main === module.
 *
 * Checks if script was called directly.
 * ES6 import.meta.url always returns the file url with path extension.
 * process.argv[1] comes from the command-line and may be extensionless.
 *
 * @module isMainESM
 *
 * @param metaURL - The import.meta.url of type string or URL instance.
 * @return {boolean} True if script was called directly, false if not.
 * */
export default metaURL => {
  // returns a boolean expression comparing the filename with an extension
  // with a potentially extensionless CLI argument
  // includes a evaluation shortcut check on the required metaURL arg existing
  return (
    metaURL &amp;&amp;
    (extname(process.argv[1])
      ? `${process.argv[1]}`
      : `${process.argv[1]}.js`) === fileURLToPath(metaURL)
  );
};

// --------------------------------------------------------------------------- //
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-id3-tags.html">id3-tags</a></li><li><a href="module-isMainESM.html">isMainESM</a></li><li><a href="module-Main.html">Main</a></li><li><a href="module-Pipe.html">Pipe</a></li><li><a href="module-Utils.html">Utils</a></li></ul><h3>Global</h3><ul><li><a href="global.html#argsHandle">argsHandle</a></li><li><a href="global.html#cleanBashRoot">cleanBashRoot</a></li><li><a href="global.html#cleanCwdSyncPipe">cleanCwdSyncPipe</a></li><li><a href="global.html#cleanFileURL">cleanFileURL</a></li><li><a href="global.html#cleanGlobSyncPipe">cleanGlobSyncPipe</a></li><li><a href="global.html#cleanPathAsyncPipe">cleanPathAsyncPipe</a></li><li><a href="global.html#cleanSysRoot">cleanSysRoot</a></li><li><a href="global.html#getFiles">getFiles</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#inOS">inOS</a></li><li><a href="global.html#isFile">isFile</a></li><li><a href="global.html#isLetter">isLetter</a></li><li><a href="global.html#isSafeWinPath">isSafeWinPath</a></li><li><a href="global.html#isString">isString</a></li><li><a href="global.html#isSystemPath">isSystemPath</a></li><li><a href="global.html#pipeHandle">pipeHandle</a></li><li><a href="global.html#posixPath">posixPath</a></li><li><a href="global.html#promptHandle">promptHandle</a></li><li><a href="global.html#syncPipe">syncPipe</a></li><li><a href="global.html#tweakTags">tweakTags</a></li><li><a href="global.html#tweakTagsObject">tweakTagsObject</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Thu Feb 10 2022 22:15:11 GMT+1300 (New Zealand Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
